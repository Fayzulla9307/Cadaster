{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from \"axios\";\nimport Login from \"@/views/Login.vue\";\nexport default {\n  name: \"App\",\n  data() {\n    return {\n      isAuthenticated: false,\n      loaded: false\n    };\n  },\n  methods: {\n    checkAuth() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      const url = this.$BASE_URL + \"/auth/validate_token/\";\n      console.log(url);\n      axios.post(url, {}, {\n        headers\n      }).then(response => {\n        this.loaded = true;\n        if (response.data[0].valid) {\n          this.isAuthenticated = true;\n          //this.$router.push(\"/main/\");\n        } else {\n          this.isAuthenticated = false;\n        }\n      });\n    },\n    logout() {\n      sessionStorage.setItem(\"token\", null);\n      this.isAuthenticated = false;\n      this.$router.push(\"/\");\n    },\n    pollAuthData() {\n      this.polling = setInterval(() => {\n        this.checkAuth();\n      }, 60000);\n    }\n  },\n  mounted() {\n    this.checkAuth();\n    this.pollAuthData();\n    this.$router.push(\"/\");\n  },\n  components: {\n    Login\n  }\n};","map":{"version":3,"names":["axios","Login","name","data","isAuthenticated","loaded","methods","checkAuth","token","sessionStorage","getItem","headers","Authorization","url","$BASE_URL","console","log","post","then","response","valid","logout","setItem","$router","push","pollAuthData","polling","setInterval","mounted","components"],"sources":["/Users/fayzulla/Dev/kadastr/frontend/kadastr/src/App.vue"],"sourcesContent":["<template>\n  <div v-if=\"loaded\">\n    <div v-if=\"isAuthenticated\">\n      <div class=\"title\">Система ведения кадастровой инфомации</div>\n      <div class=\"menu_container\">\n        <div class=\"menu\">\n          <div id=\"nav\">\n            <img\n              src=\"@/assets/micromine.png\"\n              alt=\"Micromine\"\n              width=\"150\"\n              id=\"logo_top\"\n            />\n            <!-- MainWindow / -->\n            <router-link to=\"/dicts\">Общие справочники</router-link> |\n            <router-link to=\"/districts\">Справочники районов</router-link> |\n            <router-link to=\"/deposits\">Месторождения</router-link> |\n            <!-- router-link to=\"/transfer\">Мастер переноса</router-link> | -->\n            <!-- router-link to=\"/protocols\">Протоколы</router-link> | -->\n            <router-link to=\"/reports\">Отчеты</router-link> |\n            <router-link to=\"/security\">Безопасность</router-link> |\n            <router-link to=\"/about\">О программе</router-link> |\n            <!-- router-link to=\"/configuration\">Настройки</router-link> | -->\n            <a href=\"#\" @click=\"logout()\">Выход</a>\n          </div>\n        </div>\n      </div>\n      <router-view></router-view>\n    </div>\n    <div v-if=\"!isAuthenticated\">\n      <Login />\n      <img src=\"@/assets/micromine.png\" alt=\"Micromine\" width=\"150\" id=\"logo\" />\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport Login from \"@/views/Login.vue\";\n\nexport default {\n  name: \"App\",\n  data() {\n    return {\n      isAuthenticated: false,\n      loaded: false,\n    };\n  },\n  methods: {\n    checkAuth() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/auth/validate_token/\";\n      console.log(url);\n      axios.post(url, {}, { headers }).then((response) => {\n        this.loaded = true;\n        if (response.data[0].valid) {\n          this.isAuthenticated = true;\n          //this.$router.push(\"/main/\");\n        } else {\n          this.isAuthenticated = false;\n        }\n      });\n    },\n    logout() {\n      sessionStorage.setItem(\"token\", null);\n      this.isAuthenticated = false;\n      this.$router.push(\"/\");\n    },\n    pollAuthData() {\n      this.polling = setInterval(() => {\n        this.checkAuth();\n      }, 60000);\n    },\n  },\n  mounted() {\n    this.checkAuth();\n    this.pollAuthData();\n    this.$router.push(\"/\");\n  },\n  components: {\n    Login,\n  },\n};\n</script>\n\n<style scoped>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  width: 100%;\n}\n\n#nav {\n  padding: 30px;\n}\n\n#nav a {\n  font-weight: bold;\n  color: #2c3e50;\n}\n\n#nav a.router-link-exact-active {\n  color: #42b983;\n}\n\n#logo {\n  position: absolute;\n  bottom: 20px;\n  margin-left: 20px;\n}\n\n#logo_top {\n  position: absolute;\n  display: block;\n  margin-left: 3.4%;\n}\n\n.title {\n  width: 100%;\n  text-align: center;\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  font-weight: bold;\n}\n</style>\n"],"mappings":";AAqCA,OAAOA,KAAI,MAAO,OAAO;AACzB,OAAOC,KAAI,MAAO,mBAAmB;AAErC,eAAe;EACbC,IAAI,EAAE,KAAK;EACXC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,eAAe,EAAE,KAAK;MACtBC,MAAM,EAAE;IACV,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,SAASA,CAAA,EAAG;MACV,MAAMC,KAAI,GAAIC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;MAC7C,MAAMC,OAAM,GAAI;QACd,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAE,SAAQ,GAAIJ;MAC7B,CAAC;MACD,MAAMK,GAAE,GAAI,IAAI,CAACC,SAAQ,GAAI,uBAAuB;MACpDC,OAAO,CAACC,GAAG,CAACH,GAAG,CAAC;MAChBb,KAAK,CAACiB,IAAI,CAACJ,GAAG,EAAE,CAAC,CAAC,EAAE;QAAEF;MAAQ,CAAC,CAAC,CAACO,IAAI,CAAEC,QAAQ,IAAK;QAClD,IAAI,CAACd,MAAK,GAAI,IAAI;QAClB,IAAIc,QAAQ,CAAChB,IAAI,CAAC,CAAC,CAAC,CAACiB,KAAK,EAAE;UAC1B,IAAI,CAAChB,eAAc,GAAI,IAAI;UAC3B;QACF,OAAO;UACL,IAAI,CAACA,eAAc,GAAI,KAAK;QAC9B;MACF,CAAC,CAAC;IACJ,CAAC;IACDiB,MAAMA,CAAA,EAAG;MACPZ,cAAc,CAACa,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC;MACrC,IAAI,CAAClB,eAAc,GAAI,KAAK;MAC5B,IAAI,CAACmB,OAAO,CAACC,IAAI,CAAC,GAAG,CAAC;IACxB,CAAC;IACDC,YAAYA,CAAA,EAAG;MACb,IAAI,CAACC,OAAM,GAAIC,WAAW,CAAC,MAAM;QAC/B,IAAI,CAACpB,SAAS,EAAE;MAClB,CAAC,EAAE,KAAK,CAAC;IACX;EACF,CAAC;EACDqB,OAAOA,CAAA,EAAG;IACR,IAAI,CAACrB,SAAS,EAAE;IAChB,IAAI,CAACkB,YAAY,EAAE;IACnB,IAAI,CAACF,OAAO,CAACC,IAAI,CAAC,GAAG,CAAC;EACxB,CAAC;EACDK,UAAU,EAAE;IACV5B;EACF;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}