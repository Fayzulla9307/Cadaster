{"ast":null,"code":"import axios from \"axios\";\nimport BootstrapIcon from \"@dvuckovic/vue3-bootstrap-icons\";\nimport EditMineAreaModal from \"../components/EditMineAreaModal.vue\";\nimport ConfirmModal from \"../components/ConfirmModal.vue\";\nimport OkModal from \"./OkModal.vue\";\nimport ProtocolEditModal from \"../components/ProtocolEditModal.vue\";\nimport ComponentSelectionModal from \"../components/ComponentSelectionModal.vue\";\nexport default {\n  name: \"MineAreaItem\",\n  props: [\"deposit_id\", \"mine_area_id\", \"mine_area_name\"],\n  data() {\n    return {\n      depositId: this.deposit_id,\n      mineAreaId: this.mine_area_id,\n      mineAreaName: this.mine_area_name,\n      showEditMineAreaModal: false,\n      showEditReserves: false,\n      confirmMessage: \"\",\n      confirmHeader: \"\",\n      showConfirmModal: false,\n      showAuthError: false,\n      authMessage: \"Доступ запрещен\",\n      authHeader: \"Ошибка безопасности\",\n      showComponentSelectionModal: false,\n      showProtocolEditModal: false\n    };\n  },\n  methods: {\n    closeProtocolEditModal() {\n      this.showProtocolEditModal = false;\n    },\n    selectComponent(data) {\n      this.showComponentSelectionModal = false;\n      this.component_id = data.component_id;\n      this.showProtocolEditModal = true;\n    },\n    closeAllWindows() {\n      this.showComponentSelectionModal = false;\n    },\n    openProtocolModal() {\n      this.showComponentSelectionModal = true;\n    },\n    hideAuthMessage() {\n      this.showAuthError = false;\n    },\n    onConfirm() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      const url = this.$BASE_URL + \"/api/delete_mine_area/\";\n      axios.post(url, {\n        deposit_id: this.depositId,\n        mine_area_id: this.mine_area_id\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          this.$emit(\"mine-area-deleted\", {});\n        } else {\n          this.showAuthError = true;\n        }\n      });\n    },\n    onCancel() {\n      this.showConfirmModal = false;\n    },\n    removeItem(e) {\n      this.confirmMessage = \"Удалить участок? Это приведет к потере данных (лицензий, запасов, а также всех движений и исторических данных!)\";\n      this.confirmHeader = \"Удаление данных!\";\n      this.showConfirmModal = true;\n      e.preventDefault();\n    },\n    editItem(e) {\n      this.showEditMineAreaModal = true;\n      /*this.$emit('mine-area-edited', {\n          \"deposit_id\": this.depositId,\n          \"mine_area_id\": this.mineAreaId\n        });\n      */\n      e.preventDefault();\n    },\n    editReserves(e) {\n      //this.$emit('reserves-edited-for-deposit', {\"deposit_id\": this.depositId});\n      this.showEditReserves = true;\n      e.preventDefault();\n    },\n    closeEditReserves() {\n      this.showEditReserves = false;\n      //e.preventDefault();\n    },\n\n    closeMineAreaEdit() {\n      this.showEditMineAreaModal = false;\n    },\n    saveMineAreaEdit(mineArea) {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      const url = this.$BASE_URL + \"/api/update_mine_area/\";\n      axios.post(url, mineArea, {\n        headers\n      }).then(() => {\n        this.$emit(\"mine-area-edited\");\n      });\n      this.showEditMineAreaModal = false;\n    }\n  },\n  components: {\n    EditMineAreaModal,\n    BootstrapIcon,\n    ConfirmModal,\n    OkModal,\n    ProtocolEditModal,\n    ComponentSelectionModal\n  },\n  mounted() {}\n};","map":{"version":3,"names":["axios","BootstrapIcon","EditMineAreaModal","ConfirmModal","OkModal","ProtocolEditModal","ComponentSelectionModal","name","props","data","depositId","deposit_id","mineAreaId","mine_area_id","mineAreaName","mine_area_name","showEditMineAreaModal","showEditReserves","confirmMessage","confirmHeader","showConfirmModal","showAuthError","authMessage","authHeader","showComponentSelectionModal","showProtocolEditModal","methods","closeProtocolEditModal","selectComponent","component_id","closeAllWindows","openProtocolModal","hideAuthMessage","onConfirm","token","sessionStorage","getItem","headers","Authorization","url","$BASE_URL","post","then","response","auth_fail","$emit","onCancel","removeItem","e","preventDefault","editItem","editReserves","closeEditReserves","closeMineAreaEdit","saveMineAreaEdit","mineArea","components","mounted"],"sources":["/Users/fayzulla/Dev/kadastr/frontend/kadastr/src/components/MineAreaItem.vue"],"sourcesContent":["<template>\n  <div class=\"item\">\n    <ConfirmModal\n      v-if=\"showConfirmModal\"\n      v-bind:message=\"confirmMessage\"\n      v-bind:header=\"confirmHeader\"\n      v-on:confirm=\"onConfirm\"\n      v-on:cancel=\"onCancel\"\n    />\n    <EditMineAreaModal\n      v-bind:deposit_id=\"depositId\"\n      v-bind:mine_area_id=\"mineAreaId\"\n      v-on:save-edit-mine-area=\"saveMineAreaEdit\"\n      v-on:close-edit-mine-area=\"closeMineAreaEdit\"\n      v-if=\"showEditMineAreaModal\"\n    />\n    <OkModal\n      v-if=\"showAuthError\"\n      v-bind:message=\"authMessage\"\n      v-bind:header=\"authHeader\"\n      v-on:confirm=\"hideAuthMessage\"\n    />\n    <ProtocolEditModal\n      v-bind:deposit_id=\"deposit_id\"\n      v-bind:mine_area_id=\"mine_area_id\"\n      v-bind:component_id=\"component_id\"\n      v-if=\"showProtocolEditModal\"\n      v-on:reselect=\"closeProtocolEditModal\"\n    />\n    <ComponentSelectionModal\n      v-if=\"showComponentSelectionModal\"\n      v-bind:deposit_id=\"deposit_id\"\n      v-bind:mine_area_id=\"mine_area_id\"\n      v-on:confirm=\"selectComponent\"\n      v-on:cancel=\"closeAllWindows\"\n    />\n    <table style=\"border-style: none !important; width: 100%\">\n      <tr style=\"border-style: none !important; width: 100%\">\n        <td style=\"width: 50px; border-style: none !important\">\n          <button\n            @click=\"removeItem\"\n            class=\"btn btn-dark btn-lg btn-block\"\n            style=\"float: left; width: 200px\"\n          >\n            <BootstrapIcon icon=\"trash\" />\n            Удалить\n          </button>\n        </td>\n        <td style=\"width: 50px\">\n          <button\n            @click=\"editItem\"\n            class=\"btn btn-dark btn-lg btn-block\"\n            style=\"float: left; width: 200px\"\n          >\n            <BootstrapIcon icon=\"pencil\" />\n            Редактировать\n          </button>\n        </td>\n        <td style=\"width: 50px\">\n          <button\n            @click=\"openProtocolModal\"\n            class=\"btn btn-dark btn-lg btn-block\"\n            style=\"float: left; width: 200px\"\n          >\n            <BootstrapIcon icon=\"file-word\" />\n            Протокол\n          </button>\n        </td>\n        <td style=\"width: 100%\">\n          <input\n            type=\"text\"\n            class=\"form-control form-control-lg\"\n            style=\"display: inline; width: calc(100%)\"\n            v-model=\"mineAreaName\"\n            disabled\n          />\n        </td>\n      </tr>\n    </table>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\n\nimport BootstrapIcon from \"@dvuckovic/vue3-bootstrap-icons\";\nimport EditMineAreaModal from \"../components/EditMineAreaModal.vue\";\nimport ConfirmModal from \"../components/ConfirmModal.vue\";\nimport OkModal from \"./OkModal.vue\";\nimport ProtocolEditModal from \"../components/ProtocolEditModal.vue\";\nimport ComponentSelectionModal from \"../components/ComponentSelectionModal.vue\";\n\nexport default {\n  name: \"MineAreaItem\",\n  props: [\"deposit_id\", \"mine_area_id\", \"mine_area_name\"],\n  data() {\n    return {\n      depositId: this.deposit_id,\n      mineAreaId: this.mine_area_id,\n      mineAreaName: this.mine_area_name,\n      showEditMineAreaModal: false,\n      showEditReserves: false,\n      confirmMessage: \"\",\n      confirmHeader: \"\",\n      showConfirmModal: false,\n      showAuthError: false,\n      authMessage: \"Доступ запрещен\",\n      authHeader: \"Ошибка безопасности\",\n      showComponentSelectionModal: false,\n      showProtocolEditModal: false,\n    };\n  },\n  methods: {\n    closeProtocolEditModal() {\n      this.showProtocolEditModal = false;\n    },\n    selectComponent(data) {\n      this.showComponentSelectionModal = false;\n      this.component_id = data.component_id;\n      this.showProtocolEditModal = true;\n    },\n    closeAllWindows() {\n      this.showComponentSelectionModal = false;\n    },\n    openProtocolModal() {\n      this.showComponentSelectionModal = true;\n    },\n    hideAuthMessage() {\n      this.showAuthError = false;\n    },\n    onConfirm() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/api/delete_mine_area/\";\n      axios\n        .post(\n          url,\n          { deposit_id: this.depositId, mine_area_id: this.mine_area_id },\n          { headers }\n        )\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.$emit(\"mine-area-deleted\", {});\n          } else {\n            this.showAuthError = true;\n          }\n        });\n    },\n    onCancel() {\n      this.showConfirmModal = false;\n    },\n    removeItem(e) {\n      this.confirmMessage =\n        \"Удалить участок? Это приведет к потере данных (лицензий, запасов, а также всех движений и исторических данных!)\";\n      this.confirmHeader = \"Удаление данных!\";\n      this.showConfirmModal = true;\n      e.preventDefault();\n    },\n    editItem(e) {\n      this.showEditMineAreaModal = true;\n      /*this.$emit('mine-area-edited', {\n          \"deposit_id\": this.depositId,\n          \"mine_area_id\": this.mineAreaId\n        });\n      */\n      e.preventDefault();\n    },\n    editReserves(e) {\n      //this.$emit('reserves-edited-for-deposit', {\"deposit_id\": this.depositId});\n      this.showEditReserves = true;\n      e.preventDefault();\n    },\n    closeEditReserves() {\n      this.showEditReserves = false;\n      //e.preventDefault();\n    },\n    closeMineAreaEdit() {\n      this.showEditMineAreaModal = false;\n    },\n    saveMineAreaEdit(mineArea) {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/api/update_mine_area/\";\n      axios.post(url, mineArea, { headers }).then(() => {\n        this.$emit(\"mine-area-edited\");\n      });\n      this.showEditMineAreaModal = false;\n    },\n  },\n  components: {\n    EditMineAreaModal,\n    BootstrapIcon,\n    ConfirmModal,\n    OkModal,\n    ProtocolEditModal,\n    ComponentSelectionModal,\n  },\n  mounted() {},\n};\n</script>\n\n<style scoped>\nimg {\n  height: 30px;\n  width: 30px;\n}\n\n.item {\n  width: calc(100%);\n  height: 50px;\n  font-weight: bolder;\n  font-family: \"Gill Sans\", \"Gill Sans MT\", Calibri, \"Trebuchet MS\", sans-serif;\n  border-style: none !important;\n}\n.delete-btn {\n  height: 30px;\n  display: inline;\n  /*margin-right: 5px;*/\n}\n.save-btn {\n  height: 30px;\n  display: inline-block;\n  /*margin-right: 5px;*/\n}\n.inputfield {\n  display: inline;\n  height: 30px;\n  width: 330px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}