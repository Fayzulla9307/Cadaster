{"ast":null,"code":"import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, vModelSelect as _vModelSelect, withDirectives as _withDirectives, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-6dcf5dde\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"modal-mask\"\n};\nconst _hoisted_2 = {\n  class: \"modal-window\"\n};\nconst _hoisted_3 = {\n  class: \"header\"\n};\nconst _hoisted_4 = {\n  class: \"message\"\n};\nconst _hoisted_5 = {\n  class: \"form-group col-xs-3\"\n};\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  style: {\n    \"float\": \"left\"\n  }\n}, \"Полезные ископаемые доступные для месторождения\", -1 /* HOISTED */));\nconst _hoisted_7 = [\"value\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_OkModal = _resolveComponent(\"OkModal\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [$data.showError ? (_openBlock(), _createBlock(_component_OkModal, {\n    key: 0,\n    message: $data.errorMessage,\n    header: $data.errorHeader,\n    onConfirm: $options.hideErrorMessage\n  }, null, 8 /* PROPS */, [\"message\", \"header\", \"onConfirm\"])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_3, _toDisplayString($data.header), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_hoisted_6, _withDirectives(_createElementVNode(\"select\", {\n    class: \"form-select form-control-lg\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.selectedComponentId = $event),\n    \"aria-label\": \"Полезные ископаемые доступные для месторождения\"\n  }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.components, c => {\n    return _openBlock(), _createElementBlock(\"option\", {\n      value: c.component_id,\n      key: c.component_id\n    }, _toDisplayString(c.component_name), 9 /* TEXT, PROPS */, _hoisted_7);\n  }), 128 /* KEYED_FRAGMENT */))], 512 /* NEED_PATCH */), [[_vModelSelect, $data.selectedComponentId]])])]), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.confirm && $options.confirm(...args)),\n    class: \"btn btn-dark btn-lg btn-block next\"\n  }, \" Далее \"), _createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.cancel && $options.cancel(...args)),\n    class: \"btn btn-dark btn-lg btn-block close\"\n  }, \" Отменить \")])]);\n}","map":{"version":3,"names":["class","_createElementVNode","style","_createElementBlock","_hoisted_1","_hoisted_2","$data","showError","_createBlock","_component_OkModal","message","errorMessage","header","errorHeader","onConfirm","$options","hideErrorMessage","_hoisted_3","_toDisplayString","_hoisted_4","_hoisted_5","_hoisted_6","selectedComponentId","$event","_Fragment","_renderList","components","c","value","component_id","key","component_name","_hoisted_7","onClick","_cache","args","confirm","cancel"],"sources":["/Users/fayzulla/Dev/kadastr/frontend/kadastr/src/components/ComponentSelectionModal.vue"],"sourcesContent":["<template>\n  <div class=\"modal-mask\">\n    <div class=\"modal-window\">\n      <OkModal\n        v-if=\"showError\"\n        v-bind:message=\"errorMessage\"\n        v-bind:header=\"errorHeader\"\n        v-on:confirm=\"hideErrorMessage\"\n      />\n      <div class=\"header\">{{ header }}</div>\n      <div class=\"message\">\n        <div class=\"form-group col-xs-3\">\n          <label style=\"float: left\"\n            >Полезные ископаемые доступные для месторождения</label\n          >\n          <select\n            class=\"form-select form-control-lg\"\n            v-model=\"selectedComponentId\"\n            aria-label=\"Полезные ископаемые доступные для месторождения\"\n          >\n            <option\n              v-for=\"c in components\"\n              v-bind:value=\"c.component_id\"\n              v-bind:key=\"c.component_id\"\n            >\n              {{ c.component_name }}\n            </option>\n          </select>\n        </div>\n      </div>\n      <button @click=\"confirm\" class=\"btn btn-dark btn-lg btn-block next\">\n        Далее\n      </button>\n      <button @click=\"cancel\" class=\"btn btn-dark btn-lg btn-block close\">\n        Отменить\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport OkModal from \"../components/OkModal.vue\";\n\nexport default {\n  name: \"ComponentSelectionModal\",\n  props: [\"deposit_id\", \"mine_area_id\"],\n  data() {\n    return {\n      components: [],\n      header: \"Выбор полезного ископаемого\",\n      selectedComponentId: null,\n      showError: false,\n      errorMessage:\n        \"Для данного месторождения отсутствуют записи по полезным ископаемым! Вам стоит выбрать полезное ископаемое или отменить действия мастера!\",\n      errorHeader: \"Нет данных по полезным ископаемым\",\n    };\n  },\n  methods: {\n    hideErrorMessage() {\n      this.getAllComponents();\n    },\n    getAllComponents() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/api/get_dictionary_contents/\";\n      axios\n        .post(\n          url,\n          { category: \"SPR_POL\", offset: 0, limit: 10000 },\n          { headers }\n        )\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            var result = response.data[0].result;\n            this.components = [];\n            for (var i = 0; i < result.length; i++) {\n              this.components.push({\n                deposit_id: this.deposit_id,\n                mine_area_id: this.mine_area_id,\n                component_id: result[i].id,\n                component_name: result[i].description,\n              });\n            }\n            this.showError = false;\n          }\n        });\n    },\n    getComponentsForDeposit() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/api/get_available_components_for_deposit/\";\n      axios\n        .post(\n          url,\n          { deposit_id: this.deposit_id, mine_area_id: this.mine_area_id },\n          { headers }\n        )\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.components = response.data[0].result;\n            if (this.components.length == 0) {\n              this.showError = true;\n            }\n          }\n        });\n    },\n    cancel() {\n      this.$emit(\"cancel\", {});\n    },\n    confirm() {\n      if (this.selectedComponentId == null) {\n        this.errorHeader = \"Ошибка при вводе данных\";\n        this.errorMessage = \"Не выбрано полезное ископаемое!\";\n        this.showError = true;\n      } else {\n        this.$emit(\"confirm\", {\n          deposit_id: this.deposit_id,\n          mine_area_id: this.mine_area_id,\n          component_id: this.selectedComponentId,\n        });\n      }\n    },\n  },\n  components: {\n    OkModal,\n  },\n  mounted() {\n    this.getAllComponents();\n  },\n};\n</script>\n\n<style scoped>\n.modal-mask {\n  position: fixed;\n  z-index: 1000094;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  transition: opacity 0.3s ease;\n}\n\n.modal-window {\n  border: rgb(169, 255, 202);\n  background-color: white;\n  position: fixed;\n  width: 400px;\n  height: 200px;\n  top: 50%;\n  left: 50%;\n  margin-top: -100px;\n  margin-left: -200px;\n  z-index: 1000095;\n}\n\n.header {\n  height: 30px;\n  width: 100%;\n  background-color: rgb(143, 150, 150);\n  text-align: center;\n  font-weight: bold;\n}\n\n.message {\n  font-weight: bolder;\n  color: black;\n  text-align: center;\n}\n\n.close {\n  position: absolute;\n  bottom: 10px;\n  left: 10px;\n}\n\n.next {\n  position: absolute;\n  bottom: 10px;\n  right: 10px;\n}\n</style>\n"],"mappings":";;;EACOA,KAAK,EAAC;AAAY;;EAChBA,KAAK,EAAC;AAAc;;EAOlBA,KAAK,EAAC;AAAQ;;EACdA,KAAK,EAAC;AAAS;;EACbA,KAAK,EAAC;AAAqB;gEAC9BC,mBAAA,CAEC;EAFMC,KAAmB,EAAnB;IAAA;EAAA;AAAmB,GACvB,iDAA+C;;;;uBAZ1DC,mBAAA,CAoCM,OApCNC,UAoCM,GAnCJH,mBAAA,CAkCM,OAlCNI,UAkCM,GAhCIC,KAAA,CAAAC,SAAS,I,cADjBC,YAAA,CAKEC,kBAAA;;IAHOC,OAAO,EAAEJ,KAAA,CAAAK,YAAY;IACrBC,MAAM,EAAEN,KAAA,CAAAO,WAAW;IACrBC,SAAO,EAAEC,QAAA,CAAAC;oGAEhBf,mBAAA,CAAsC,OAAtCgB,UAAsC,EAAAC,gBAAA,CAAfZ,KAAA,CAAAM,MAAM,kBAC7BX,mBAAA,CAmBM,OAnBNkB,UAmBM,GAlBJlB,mBAAA,CAiBM,OAjBNmB,UAiBM,GAhBJC,UAEC,E,gBACDpB,mBAAA,CAYS;IAXPD,KAAK,EAAC,6BAA6B;+DAC1BM,KAAA,CAAAgB,mBAAmB,GAAAC,MAAA;IAC5B,YAAU,EAAC;yBAEXpB,mBAAA,CAMSqB,SAAA,QAAAC,WAAA,CALKnB,KAAA,CAAAoB,UAAU,EAAfC,CAAC;yBADVxB,mBAAA,CAMS;MAJAyB,KAAK,EAAED,CAAC,CAACE,YAAY;MACrBC,GAAG,EAAEH,CAAC,CAACE;wBAEXF,CAAC,CAACI,cAAc,wBAAAC,UAAA;2EARZ1B,KAAA,CAAAgB,mBAAmB,E,OAalCrB,mBAAA,CAES;IAFAgC,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEpB,QAAA,CAAAqB,OAAA,IAAArB,QAAA,CAAAqB,OAAA,IAAAD,IAAA,CAAO;IAAEnC,KAAK,EAAC;KAAqC,SAEpE,GACAC,mBAAA,CAES;IAFAgC,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEpB,QAAA,CAAAsB,MAAA,IAAAtB,QAAA,CAAAsB,MAAA,IAAAF,IAAA,CAAM;IAAEnC,KAAK,EAAC;KAAsC,YAEpE,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}