{"ast":null,"code":"import axios from \"axios\";\nimport PropertyItem from \"../components/PropertyItem.vue\";\nimport ProperyNewItem from \"../components/PropertyNewItem.vue\";\nimport Paginator from \"../components/Paginator.vue\";\nimport Filter from \"../components/Filter.vue\";\nimport Spinner from \"../components/Spinner.vue\";\nexport default {\n  name: \"PropertyTable\",\n  props: [\"category\"],\n  watch: {\n    category: {\n      deep: true,\n      handler(n) {\n        this.categoryLocal = n;\n        this.page = 1;\n        this.countItems();\n        this.loadItems();\n      }\n    }\n  },\n  data() {\n    return {\n      items: [],\n      categoryLocal: this.category,\n      totalItems: 0,\n      page: 1,\n      ipp: 10,\n      filter: \"\",\n      loadedItems: 0,\n      showSpinner: true\n    };\n  },\n  methods: {\n    countItems() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      var url = this.$BASE_URL + \"/api/get_dictionary_count/\";\n      axios.post(url, {\n        category: this.categoryLocal,\n        item: this.filter\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data.auth_fail) {\n          this.totalItems = response.data.result;\n        }\n      });\n    },\n    loadItems() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      var url = this.$BASE_URL + \"/api/get_dictionary_contents/\";\n      const offset = (this.page - 1) * this.ipp;\n      axios.post(url, {\n        category: this.categoryLocal,\n        item: this.filter,\n        offset: offset,\n        limit: this.ipp\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          console.log(JSON.stringify(response.data[0].result));\n          this.items = response.data[0].result;\n        }\n      });\n    },\n    onItemLoaded() {\n      this.loadedItems++;\n      //alert(this.totalItems + \" \" + this.loadedItems)\n      if (this.loadedItems == this.ipp) {\n        this.loadedItems = 0;\n        this.showSpinner = false;\n      }\n      if (this.loadedItems == 0 && this.totalItems - this.ipp * Math.floor(this.totalItems / this.ipp)) {\n        this.loadedItems = 0;\n        this.showSpinner = false;\n      }\n      if (this.loadedItems == this.totalItems) {\n        this.loadedItems = 0;\n        this.showSpinner = false;\n      }\n    },\n    changePage(o) {\n      this.page = o.page;\n      this.loadItems();\n    },\n    updated() {\n      this.page = 1;\n      this.filter = \"\";\n      this.countItems();\n      this.loadItems();\n    },\n    filterTable(filter) {\n      this.page = 1;\n      this.filter = filter;\n      this.countItems();\n      this.loadItems();\n    }\n  },\n  components: {\n    PropertyItem,\n    ProperyNewItem,\n    Paginator,\n    Filter,\n    Spinner\n  },\n  mounted() {\n    this.countItems();\n    this.loadItems();\n  }\n};","map":{"version":3,"names":["axios","PropertyItem","ProperyNewItem","Paginator","Filter","Spinner","name","props","watch","category","deep","handler","n","categoryLocal","page","countItems","loadItems","data","items","totalItems","ipp","filter","loadedItems","showSpinner","methods","token","sessionStorage","getItem","headers","Authorization","url","$BASE_URL","post","item","then","response","auth_fail","result","offset","limit","console","log","JSON","stringify","onItemLoaded","Math","floor","changePage","o","updated","filterTable","components","mounted"],"sources":["/Users/fayzulla/Dev/kadastr/frontend/kadastr/src/components/PropertyTable.vue"],"sourcesContent":["<template>\n  <div class=\"table\">\n    <Spinner v-if=\"showSpinner\" />\n    <Filter v-on:filter=\"filterTable\" v-bind:filterVal=\"filter\" />\n    <PropertyItem\n      v-for=\"item in items\"\n      v-bind:key=\"item.id\"\n      v-bind:displayButtons=\"true\"\n      v-bind:id=\"item.id\"\n      v-bind:category=\"item.category\"\n      v-bind:description=\"item.description\"\n      v-on:updated=\"updated\"\n      v-on:loaded=\"onItemLoaded\"\n    />\n    <ProperyNewItem v-bind:category=\"categoryLocal\" v-on:updated=\"updated\" />\n    <Paginator\n      v-bind:count=\"totalItems\"\n      v-bind:ipp=\"ipp\"\n      v-bind:currentPage=\"page\"\n      v-on:page-click=\"changePage\"\n    />\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport PropertyItem from \"../components/PropertyItem.vue\";\nimport ProperyNewItem from \"../components/PropertyNewItem.vue\";\nimport Paginator from \"../components/Paginator.vue\";\nimport Filter from \"../components/Filter.vue\";\nimport Spinner from \"../components/Spinner.vue\";\n\nexport default {\n  name: \"PropertyTable\",\n  props: [\"category\"],\n  watch: {\n    category: {\n      deep: true,\n      handler(n) {\n        this.categoryLocal = n;\n        this.page = 1;\n        this.countItems();\n        this.loadItems();\n      },\n    },\n  },\n  data() {\n    return {\n      items: [],\n      categoryLocal: this.category,\n      totalItems: 0,\n      page: 1,\n      ipp: 10,\n      filter: \"\",\n      loadedItems: 0,\n      showSpinner: true,\n    };\n  },\n  methods: {\n    countItems() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/get_dictionary_count/\";\n      axios\n        .post(\n          url,\n          { category: this.categoryLocal, item: this.filter },\n          { headers }\n        )\n        .then((response) => {\n          if (!response.data.auth_fail) {\n            this.totalItems = response.data.result;\n          }\n        });\n    },\n    loadItems() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/get_dictionary_contents/\";\n      const offset = (this.page - 1) * this.ipp;\n      axios\n        .post(\n          url,\n          {\n            category: this.categoryLocal,\n            item: this.filter,\n            offset: offset,\n            limit: this.ipp,\n          },\n          { headers }\n        )\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            console.log(JSON.stringify(response.data[0].result));\n            this.items = response.data[0].result;\n          }\n        });\n    },\n    onItemLoaded() {\n      this.loadedItems++;\n      //alert(this.totalItems + \" \" + this.loadedItems)\n      if (this.loadedItems == this.ipp) {\n        this.loadedItems = 0;\n        this.showSpinner = false;\n      }\n      if (\n        this.loadedItems == 0 &&\n        this.totalItems - this.ipp * Math.floor(this.totalItems / this.ipp)\n      ) {\n        this.loadedItems = 0;\n        this.showSpinner = false;\n      }\n      if (this.loadedItems == this.totalItems) {\n        this.loadedItems = 0;\n        this.showSpinner = false;\n      }\n    },\n    changePage(o) {\n      this.page = o.page;\n      this.loadItems();\n    },\n    updated() {\n      this.page = 1;\n      this.filter = \"\";\n      this.countItems();\n      this.loadItems();\n    },\n    filterTable(filter) {\n      this.page = 1;\n      this.filter = filter;\n      this.countItems();\n      this.loadItems();\n    },\n  },\n  components: {\n    PropertyItem,\n    ProperyNewItem,\n    Paginator,\n    Filter,\n    Spinner,\n  },\n  mounted() {\n    this.countItems();\n    this.loadItems();\n  },\n};\n</script>\n\n<style scoped>\n.table {\n  width: 100%;\n  height: 100%;\n}\n</style>\n"],"mappings":"AAyBA,OAAOA,KAAI,MAAO,OAAO;AACzB,OAAOC,YAAW,MAAO,gCAAgC;AACzD,OAAOC,cAAa,MAAO,mCAAmC;AAC9D,OAAOC,SAAQ,MAAO,6BAA6B;AACnD,OAAOC,MAAK,MAAO,0BAA0B;AAC7C,OAAOC,OAAM,MAAO,2BAA2B;AAE/C,eAAe;EACbC,IAAI,EAAE,eAAe;EACrBC,KAAK,EAAE,CAAC,UAAU,CAAC;EACnBC,KAAK,EAAE;IACLC,QAAQ,EAAE;MACRC,IAAI,EAAE,IAAI;MACVC,OAAOA,CAACC,CAAC,EAAE;QACT,IAAI,CAACC,aAAY,GAAID,CAAC;QACtB,IAAI,CAACE,IAAG,GAAI,CAAC;QACb,IAAI,CAACC,UAAU,EAAE;QACjB,IAAI,CAACC,SAAS,EAAE;MAClB;IACF;EACF,CAAC;EACDC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE,EAAE;MACTL,aAAa,EAAE,IAAI,CAACJ,QAAQ;MAC5BU,UAAU,EAAE,CAAC;MACbL,IAAI,EAAE,CAAC;MACPM,GAAG,EAAE,EAAE;MACPC,MAAM,EAAE,EAAE;MACVC,WAAW,EAAE,CAAC;MACdC,WAAW,EAAE;IACf,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPT,UAAUA,CAAA,EAAG;MACX,MAAMU,KAAI,GAAIC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;MAC7C,MAAMC,OAAM,GAAI;QACd,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAE,SAAQ,GAAIJ;MAC7B,CAAC;MACD,IAAIK,GAAE,GAAI,IAAI,CAACC,SAAQ,GAAI,4BAA4B;MACvD/B,KAAI,CACDgC,IAAI,CACHF,GAAG,EACH;QAAErB,QAAQ,EAAE,IAAI,CAACI,aAAa;QAAEoB,IAAI,EAAE,IAAI,CAACZ;MAAO,CAAC,EACnD;QAAEO;MAAQ,EACZ,CACCM,IAAI,CAAEC,QAAQ,IAAK;QAClB,IAAI,CAACA,QAAQ,CAAClB,IAAI,CAACmB,SAAS,EAAE;UAC5B,IAAI,CAACjB,UAAS,GAAIgB,QAAQ,CAAClB,IAAI,CAACoB,MAAM;QACxC;MACF,CAAC,CAAC;IACN,CAAC;IACDrB,SAASA,CAAA,EAAG;MACV,MAAMS,KAAI,GAAIC,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;MAC7C,MAAMC,OAAM,GAAI;QACd,cAAc,EAAE,kBAAkB;QAClCC,aAAa,EAAE,SAAQ,GAAIJ;MAC7B,CAAC;MACD,IAAIK,GAAE,GAAI,IAAI,CAACC,SAAQ,GAAI,+BAA+B;MAC1D,MAAMO,MAAK,GAAI,CAAC,IAAI,CAACxB,IAAG,GAAI,CAAC,IAAI,IAAI,CAACM,GAAG;MACzCpB,KAAI,CACDgC,IAAI,CACHF,GAAG,EACH;QACErB,QAAQ,EAAE,IAAI,CAACI,aAAa;QAC5BoB,IAAI,EAAE,IAAI,CAACZ,MAAM;QACjBiB,MAAM,EAAEA,MAAM;QACdC,KAAK,EAAE,IAAI,CAACnB;MACd,CAAC,EACD;QAAEQ;MAAQ,EACZ,CACCM,IAAI,CAAEC,QAAQ,IAAK;QAClB,IAAI,CAACA,QAAQ,CAAClB,IAAI,CAAC,CAAC,CAAC,CAACmB,SAAS,EAAE;UAC/BI,OAAO,CAACC,GAAG,CAACC,IAAI,CAACC,SAAS,CAACR,QAAQ,CAAClB,IAAI,CAAC,CAAC,CAAC,CAACoB,MAAM,CAAC,CAAC;UACpD,IAAI,CAACnB,KAAI,GAAIiB,QAAQ,CAAClB,IAAI,CAAC,CAAC,CAAC,CAACoB,MAAM;QACtC;MACF,CAAC,CAAC;IACN,CAAC;IACDO,YAAYA,CAAA,EAAG;MACb,IAAI,CAACtB,WAAW,EAAE;MAClB;MACA,IAAI,IAAI,CAACA,WAAU,IAAK,IAAI,CAACF,GAAG,EAAE;QAChC,IAAI,CAACE,WAAU,GAAI,CAAC;QACpB,IAAI,CAACC,WAAU,GAAI,KAAK;MAC1B;MACA,IACE,IAAI,CAACD,WAAU,IAAK,KACpB,IAAI,CAACH,UAAS,GAAI,IAAI,CAACC,GAAE,GAAIyB,IAAI,CAACC,KAAK,CAAC,IAAI,CAAC3B,UAAS,GAAI,IAAI,CAACC,GAAG,GAClE;QACA,IAAI,CAACE,WAAU,GAAI,CAAC;QACpB,IAAI,CAACC,WAAU,GAAI,KAAK;MAC1B;MACA,IAAI,IAAI,CAACD,WAAU,IAAK,IAAI,CAACH,UAAU,EAAE;QACvC,IAAI,CAACG,WAAU,GAAI,CAAC;QACpB,IAAI,CAACC,WAAU,GAAI,KAAK;MAC1B;IACF,CAAC;IACDwB,UAAUA,CAACC,CAAC,EAAE;MACZ,IAAI,CAAClC,IAAG,GAAIkC,CAAC,CAAClC,IAAI;MAClB,IAAI,CAACE,SAAS,EAAE;IAClB,CAAC;IACDiC,OAAOA,CAAA,EAAG;MACR,IAAI,CAACnC,IAAG,GAAI,CAAC;MACb,IAAI,CAACO,MAAK,GAAI,EAAE;MAChB,IAAI,CAACN,UAAU,EAAE;MACjB,IAAI,CAACC,SAAS,EAAE;IAClB,CAAC;IACDkC,WAAWA,CAAC7B,MAAM,EAAE;MAClB,IAAI,CAACP,IAAG,GAAI,CAAC;MACb,IAAI,CAACO,MAAK,GAAIA,MAAM;MACpB,IAAI,CAACN,UAAU,EAAE;MACjB,IAAI,CAACC,SAAS,EAAE;IAClB;EACF,CAAC;EACDmC,UAAU,EAAE;IACVlD,YAAY;IACZC,cAAc;IACdC,SAAS;IACTC,MAAM;IACNC;EACF,CAAC;EACD+C,OAAOA,CAAA,EAAG;IACR,IAAI,CAACrC,UAAU,EAAE;IACjB,IAAI,CAACC,SAAS,EAAE;EAClB;AACF,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}