{"ast":null,"code":"import axios from \"axios\";\nimport BootstrapIcon from \"@dvuckovic/vue3-bootstrap-icons\";\nimport MineAreaModal from \"../components/MineAreaModal.vue\";\nimport ConfirmModal from \"../components/ConfirmModal.vue\";\nimport OkModal from \"../components/OkModal.vue\";\nimport ProtocolEditModal from \"../components/ProtocolEditModal.vue\";\nimport ComponentSelectionModal from \"../components/ComponentSelectionModal.vue\";\nexport default {\n  name: \"DepositItem\",\n  props: [\"id_deposit\", \"deposit_name\", \"type_id\", \"type\"],\n  data() {\n    return {\n      depositId: this.id_deposit,\n      depositName: this.deposit_name,\n      depositDecription: this.deposit_name + \", \" + this.type,\n      showEditReserves: false,\n      showMineAreaModal: false,\n      showDepositPropertiesModal: false,\n      confirmMessage: \"\",\n      confirmHeader: \"\",\n      showConfirmModal: false,\n      showAuthError: false,\n      authMessage: \"Доступ запрещен\",\n      authHeader: \"Ошибка безопасности\",\n      hasMineAreas: false,\n      showComponentSelectionModal: false,\n      showProtocolEditModal: false\n    };\n  },\n  methods: {\n    closeProtocolEditModal() {\n      this.showProtocolEditModal = false;\n    },\n    selectComponent(data) {\n      this.showComponentSelectionModal = false;\n      this.component_id = data.component_id;\n      this.showProtocolEditModal = true;\n    },\n    closeAllWindows() {\n      this.showComponentSelectionModal = false;\n    },\n    openProtocolModal() {\n      this.showComponentSelectionModal = true;\n    },\n    hideAuthMessage() {\n      this.showAuthError = false;\n    },\n    onConfirm() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      const url = this.$BASE_URL + \"/api/delete_deposit/\";\n      axios.post(url, {\n        deposit_id: this.depositId\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          this.$emit(\"deposit-deleted\", {});\n        } else {\n          this.showAuthError = true;\n        }\n      });\n    },\n    getHasMineAreas() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      const url = this.$BASE_URL + \"/api/has_mine_areas/\";\n      axios.post(url, {\n        deposit_id: this.depositId\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          this.hasMineAreas = response.data[0].result;\n        }\n      });\n    },\n    onCancel() {\n      this.showConfirmModal = false;\n    },\n    removeItem(e) {\n      this.confirmMessage = \"Удалить месторождение? Это приведет к потере данных (лицензий, запасов, а также всех движений и исторических данных!)\";\n      this.confirmHeader = \"Удаление данных!\";\n      this.showConfirmModal = true;\n      e.preventDefault();\n    },\n    editItem(e) {\n      this.$emit(\"deposit-edited\", {\n        deposit_id: this.depositId\n      });\n      e.preventDefault();\n    },\n    editReserves(e) {\n      //this.$emit('reserves-edited-for-deposit', {\"deposit_id\": this.depositId});\n      this.showEditReserves = true;\n      e.preventDefault();\n    },\n    closeEditReserves() {\n      this.showEditReserves = false;\n      //e.preventDefault();\n    },\n\n    editMineAreas(e) {\n      this.showMineAreaModal = true;\n      e.preventDefault();\n    },\n    editItemProperties(e) {\n      this.showDepositPropertiesModal = true;\n      e.preventDefault();\n    },\n    closeMineAreas() {\n      this.showMineAreaModal = false;\n    },\n    closeDepositPropsModal() {\n      this.showDepositPropertiesModal = false;\n    }\n  },\n  components: {\n    BootstrapIcon,\n    MineAreaModal,\n    ConfirmModal,\n    OkModal,\n    ProtocolEditModal,\n    ComponentSelectionModal\n  },\n  mounted() {\n    this.getHasMineAreas();\n  }\n};","map":{"version":3,"names":["axios","BootstrapIcon","MineAreaModal","ConfirmModal","OkModal","ProtocolEditModal","ComponentSelectionModal","name","props","data","depositId","id_deposit","depositName","deposit_name","depositDecription","type","showEditReserves","showMineAreaModal","showDepositPropertiesModal","confirmMessage","confirmHeader","showConfirmModal","showAuthError","authMessage","authHeader","hasMineAreas","showComponentSelectionModal","showProtocolEditModal","methods","closeProtocolEditModal","selectComponent","component_id","closeAllWindows","openProtocolModal","hideAuthMessage","onConfirm","token","sessionStorage","getItem","headers","Authorization","url","$BASE_URL","post","deposit_id","then","response","auth_fail","$emit","getHasMineAreas","result","onCancel","removeItem","e","preventDefault","editItem","editReserves","closeEditReserves","editMineAreas","editItemProperties","closeMineAreas","closeDepositPropsModal","components","mounted"],"sources":["/Users/fayzulla/Dev/kadastr/frontend/kadastr/src/components/DepositItem.vue"],"sourcesContent":["<template>\n  <div class=\"item\">\n    <ConfirmModal\n      v-if=\"showConfirmModal\"\n      v-bind:message=\"confirmMessage\"\n      v-bind:header=\"confirmHeader\"\n      v-on:confirm=\"onConfirm\"\n      v-on:cancel=\"onCancel\"\n    />\n    <OkModal\n      v-if=\"showAuthError\"\n      v-bind:message=\"authMessage\"\n      v-bind:header=\"authHeader\"\n      v-on:confirm=\"hideAuthMessage\"\n    />\n    <MineAreaModal\n      v-bind:deposit_id=\"depositId\"\n      v-on:mine-areas-close=\"closeMineAreas\"\n      v-if=\"showMineAreaModal\"\n    />\n    <ProtocolEditModal\n      v-bind:deposit_id=\"id_deposit\"\n      v-bind:mine_area_id=\"id_deposit\"\n      v-bind:component_id=\"component_id\"\n      v-if=\"showProtocolEditModal\"\n      v-on:reselect=\"closeProtocolEditModal\"\n    />\n    <ComponentSelectionModal\n      v-if=\"showComponentSelectionModal\"\n      v-bind:deposit_id=\"id_deposit\"\n      v-bind:mine_area_id=\"id_deposit\"\n      v-on:confirm=\"selectComponent\"\n      v-on:cancel=\"closeAllWindows\"\n    />\n    <table style=\"border-style: none !important; width: 100%\">\n      <tr style=\"border-style: none !important; width: 100%\">\n        <td style=\"width: 50px; border-style: none !important\">\n          <button\n            @click=\"removeItem\"\n            class=\"btn btn-dark btn-md btn-block btn-delete\"\n            style=\"float: left; width: 42px\" title=\"Удалить запись\"\n          >\n            <BootstrapIcon icon=\"trash\" />\n          </button>\n        </td>\n        <td style=\"width: 50px\">\n          <button\n            @click=\"editItem\"\n            class=\"btn btn-dark btn-md btn-block btn-edit\"\n            style=\"float: left; width: 42px\" title=\"Редактировать запись\"\n          >\n            <BootstrapIcon icon=\"pencil\" />\n          </button>\n        </td>\n        <td style=\"width: 50px\">\n          <button\n            @click=\"openProtocolModal\"\n            class=\"btn btn-lg btn-block\"\n            v-bind:class=\"hasMineAreas == 0 ? 'btn-dark' : 'btn-danger'\"\n            style=\"float: left; width: 200px\"\n            :disabled=\"hasMineAreas == 1\"\n          >\n            <BootstrapIcon icon=\"file-word\" />\n            Протокол\n          </button>\n        </td>\n        <td style=\"width: 50px\">\n          <button\n            @click=\"editMineAreas\"\n            class=\"btn btn-dark btn-lg btn-block\"\n            style=\"float: left; width: 200px\"\n          >\n            <BootstrapIcon icon=\"minecart-loaded\" />\n            Участки\n          </button>\n        </td>\n        <td style=\"width: 100%\">\n          <input\n            type=\"text\"\n            class=\"form-control form-control-lg\"\n            style=\"display: inline; width: calc(100%)\"\n            v-model=\"depositDecription\"\n            disabled\n          />\n        </td>\n      </tr>\n    </table>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport BootstrapIcon from \"@dvuckovic/vue3-bootstrap-icons\";\nimport MineAreaModal from \"../components/MineAreaModal.vue\";\nimport ConfirmModal from \"../components/ConfirmModal.vue\";\nimport OkModal from \"../components/OkModal.vue\";\nimport ProtocolEditModal from \"../components/ProtocolEditModal.vue\";\nimport ComponentSelectionModal from \"../components/ComponentSelectionModal.vue\";\n\nexport default {\n  name: \"DepositItem\",\n  props: [\"id_deposit\", \"deposit_name\", \"type_id\", \"type\"],\n  data() {\n    return {\n      depositId: this.id_deposit,\n      depositName: this.deposit_name,\n      depositDecription: this.deposit_name + \", \" + this.type,\n      showEditReserves: false,\n      showMineAreaModal: false,\n      showDepositPropertiesModal: false,\n      confirmMessage: \"\",\n      confirmHeader: \"\",\n      showConfirmModal: false,\n      showAuthError: false,\n      authMessage: \"Доступ запрещен\",\n      authHeader: \"Ошибка безопасности\",\n      hasMineAreas: false,\n      showComponentSelectionModal: false,\n      showProtocolEditModal: false,\n    };\n  },\n  methods: {\n    closeProtocolEditModal() {\n      this.showProtocolEditModal = false;\n    },\n    selectComponent(data) {\n      this.showComponentSelectionModal = false;\n      this.component_id = data.component_id;\n      this.showProtocolEditModal = true;\n    },\n    closeAllWindows() {\n      this.showComponentSelectionModal = false;\n    },\n    openProtocolModal() {\n      this.showComponentSelectionModal = true;\n    },\n    hideAuthMessage() {\n      this.showAuthError = false;\n    },\n    onConfirm() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/api/delete_deposit/\";\n      axios\n        .post(url, { deposit_id: this.depositId }, { headers })\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.$emit(\"deposit-deleted\", {});\n          } else {\n            this.showAuthError = true;\n          }\n        });\n    },\n    getHasMineAreas() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/api/has_mine_areas/\";\n      axios\n        .post(url, { deposit_id: this.depositId }, { headers })\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.hasMineAreas = response.data[0].result;\n          }\n        });\n    },\n    onCancel() {\n      this.showConfirmModal = false;\n    },\n    removeItem(e) {\n      this.confirmMessage =\n        \"Удалить месторождение? Это приведет к потере данных (лицензий, запасов, а также всех движений и исторических данных!)\";\n      this.confirmHeader = \"Удаление данных!\";\n      this.showConfirmModal = true;\n      e.preventDefault();\n    },\n    editItem(e) {\n      this.$emit(\"deposit-edited\", { deposit_id: this.depositId });\n      e.preventDefault();\n    },\n    editReserves(e) {\n      //this.$emit('reserves-edited-for-deposit', {\"deposit_id\": this.depositId});\n      this.showEditReserves = true;\n      e.preventDefault();\n    },\n    closeEditReserves() {\n      this.showEditReserves = false;\n      //e.preventDefault();\n    },\n    editMineAreas(e) {\n      this.showMineAreaModal = true;\n      e.preventDefault();\n    },\n    editItemProperties(e) {\n      this.showDepositPropertiesModal = true;\n      e.preventDefault();\n    },\n    closeMineAreas() {\n      this.showMineAreaModal = false;\n    },\n    closeDepositPropsModal() {\n      this.showDepositPropertiesModal = false;\n    },\n  },\n  components: {\n    BootstrapIcon,\n    MineAreaModal,\n    ConfirmModal,\n    OkModal,\n    ProtocolEditModal,\n    ComponentSelectionModal,\n  },\n  mounted() {\n    this.getHasMineAreas();\n  },\n};\n</script>\n\n<style scoped>\nimg {\n  height: 30px;\n  width: 30px;\n}\n\n.item {\n  width: calc(100%);\n  height: 50px;\n  font-weight: bolder;\n  font-family: \"Gill Sans\", \"Gill Sans MT\", Calibri, \"Trebuchet MS\", sans-serif;\n  border-style: none !important;\n}\n.delete-btn {\n  height: 30px;\n  display: inline;\n  /*margin-right: 5px;*/\n}\n.save-btn {\n  height: 30px;\n  display: inline-block;\n  /*margin-right: 5px;*/\n}\n.inputfield {\n  display: inline;\n  height: 30px;\n  width: 330px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}