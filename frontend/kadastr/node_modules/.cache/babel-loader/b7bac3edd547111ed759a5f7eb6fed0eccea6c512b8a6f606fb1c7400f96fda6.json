{"ast":null,"code":"import axios from \"axios\";\nimport OkModal from \"./OkModal.vue\";\nexport default {\n  name: \"EditDepositModal\",\n  props: [\"deposit_id\"],\n  data() {\n    return {\n      areas: [],\n      districts: [],\n      devs: [],\n      types: [],\n      failed: false,\n      depositId: this.deposit_id,\n      selectedDistrictId: null,\n      selectedAreaId: null,\n      selectedDevType: null,\n      depositName: \"\",\n      depositDesc: \"\",\n      showAuthError: false,\n      authMessage: \"Доступ запрещен\",\n      authHeader: \"Ошибка безопасности\",\n      selectedDepositTypeId: null\n    };\n  },\n  methods: {\n    hideAuthMessage() {\n      this.showAuthError = false;\n    },\n    save(e) {\n      this.$emit(\"save\", {\n        deposit_id: this.depositId,\n        deposit_name: this.depositName,\n        description: this.depositDesc,\n        development_id: this.selectedDevType,\n        area_id: this.selectedAreaId,\n        district_id: this.selectedDistrictId,\n        type_id: this.selectedDepositTypeId\n      });\n      e.preventDefault();\n    },\n    cancel(e) {\n      this.$emit(\"cancel\", {});\n      e.preventDefault();\n    },\n    getDeposit() {\n      //get_deposit\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      var url = this.$BASE_URL + \"/api/get_deposit/\";\n      axios.post(url, {\n        deposit_id: this.depositId\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          this.selectedAreaId = response.data[0].result.area_id;\n          this.selectedDistrictId = response.data[0].result.district_id;\n          this.selectedDevType = response.data[0].result.dev_id;\n          this.depositName = response.data[0].result.deposit_name;\n          this.depositDesc = response.data[0].result.description;\n          this.selectedDepositTypeId = response.data[0].result.type_id;\n          this.getAreas();\n          this.getDevelopmentStatuses();\n          this.getDepositTypes();\n        }\n      });\n    },\n    getAreas() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      var url = this.$BASE_URL + \"/api/get_areas/\";\n      axios.post(url, {\n        offset: 0,\n        limit: 20\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          this.areas = response.data[0].result;\n          this.getDistricts();\n        }\n      });\n    },\n    getDistricts() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      var url = this.$BASE_URL + \"/api/get_districts/\";\n      axios.post(url, {\n        id_area: this.selectedAreaId,\n        offset: 0,\n        limit: 1000\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          this.districts = response.data[0].result;\n        }\n      });\n    },\n    getDepositTypes() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      var url = this.$BASE_URL + \"/api/get_deposit_types/\";\n      axios.post(url, {}, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          this.types = response.data[0].result;\n        }\n      });\n    },\n    getDevelopmentStatuses() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      };\n      var url = this.$BASE_URL + \"/api/get_dictionary_contents/\";\n      axios.post(url, {\n        category: \"SPR_OSV\",\n        offset: 0,\n        limit: 10000\n      }, {\n        headers\n      }).then(response => {\n        if (!response.data[0].auth_fail) {\n          this.devs = response.data[0].result;\n        }\n      });\n    },\n    changeArea() {\n      this.getDistricts();\n    }\n  },\n  mounted() {\n    this.getDeposit();\n  },\n  components: {\n    OkModal\n  }\n};","map":{"version":3,"names":["axios","OkModal","name","props","data","areas","districts","devs","types","failed","depositId","deposit_id","selectedDistrictId","selectedAreaId","selectedDevType","depositName","depositDesc","showAuthError","authMessage","authHeader","selectedDepositTypeId","methods","hideAuthMessage","save","e","$emit","deposit_name","description","development_id","area_id","district_id","type_id","preventDefault","cancel","getDeposit","token","sessionStorage","getItem","headers","Authorization","url","$BASE_URL","post","then","response","auth_fail","result","dev_id","getAreas","getDevelopmentStatuses","getDepositTypes","offset","limit","getDistricts","id_area","category","changeArea","mounted","components"],"sources":["/Users/fayzulla/Dev/kadastr/frontend/kadastr/src/components/EditDepositModal.vue"],"sourcesContent":["<template>\n  <div class=\"modal-mask\">\n    <OkModal\n      v-if=\"showAuthError\"\n      v-bind:message=\"authMessage\"\n      v-bind:header=\"authHeader\"\n      v-on:confirm=\"hideAuthMessage\"\n    />\n    <div class=\"modal-window\">\n      <div class=\"header\">Редактирование существующего месторождения</div>\n      <div class=\"body\">\n        <form class=\"login-form\">\n          <div class=\"form-group\">\n            <label>Область</label>\n            <select\n              class=\"form-select\"\n              v-model=\"selectedAreaId\"\n              aria-label=\"Область\"\n              @change=\"changeArea\"\n            >\n              <option\n                v-for=\"area in areas\"\n                v-bind:value=\"area.id_area\"\n                v-bind:key=\"area.id_area\"\n              >\n                {{ area.area_name }}\n              </option>\n            </select>\n          </div>\n          <div class=\"form-group\">\n            <label>Район</label>\n            <select\n              class=\"form-select\"\n              v-model=\"selectedDistrictId\"\n              aria-label=\"Район\"\n            >\n              <option\n                v-for=\"district in districts\"\n                v-bind:value=\"district.id_district\"\n                v-bind:key=\"district.id_district\"\n              >\n                {{ district.district_name }}\n              </option>\n            </select>\n          </div>\n          <div class=\"form-group\">\n            <label>Степень освоения</label>\n            <select\n              class=\"form-select\"\n              v-model=\"selectedDevType\"\n              aria-label=\"Степень освоения\"\n            >\n              <option\n                v-for=\"dev in devs\"\n                v-bind:value=\"dev.id\"\n                v-bind:key=\"dev.id\"\n              >\n                {{ dev.description }}\n              </option>\n            </select>\n          </div>\n          <div class=\"form-group\">\n            <label>Тип месторождения</label>\n            <select\n              class=\"form-select\"\n              v-model=\"selectedDepositTypeId\"\n              aria-label=\"Тип месторождения\"\n              disabled\n            >\n              <option\n                v-for=\"type in types\"\n                v-bind:value=\"type.id\"\n                v-bind:key=\"type.id\"\n              >\n                {{ type.type }}\n              </option>\n            </select>\n          </div>\n          <div class=\"form-group\">\n            <label>Наименование месторождения</label>\n            <input\n              type=\"text\"\n              class=\"form-control form-control-lg\"\n              v-model=\"depositName\"\n            />\n          </div>\n          <div class=\"form-group\">\n            <label>Описание месторождения</label>\n            <textarea\n              class=\"form-control form-control-lg\"\n              v-model=\"depositDesc\"\n            ></textarea>\n          </div>\n          <div class=\"form-group\" style=\"margin-top: 10px\">\n            <button @click=\"save\" class=\"btn btn-dark btn-lg btn-block save\">\n              Сохранить\n            </button>\n            <button @click=\"cancel\" class=\"btn btn-dark btn-lg btn-block close\">\n              Отменить\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport OkModal from \"./OkModal.vue\";\n\nexport default {\n  name: \"EditDepositModal\",\n  props: [\"deposit_id\"],\n  data() {\n    return {\n      areas: [],\n      districts: [],\n      devs: [],\n      types: [],\n      failed: false,\n      depositId: this.deposit_id,\n      selectedDistrictId: null,\n      selectedAreaId: null,\n      selectedDevType: null,\n      depositName: \"\",\n      depositDesc: \"\",\n      showAuthError: false,\n      authMessage: \"Доступ запрещен\",\n      authHeader: \"Ошибка безопасности\",\n      selectedDepositTypeId: null,\n    };\n  },\n  methods: {\n    hideAuthMessage() {\n      this.showAuthError = false;\n    },\n    save(e) {\n      this.$emit(\"save\", {\n        deposit_id: this.depositId,\n        deposit_name: this.depositName,\n        description: this.depositDesc,\n        development_id: this.selectedDevType,\n        area_id: this.selectedAreaId,\n        district_id: this.selectedDistrictId,\n        type_id: this.selectedDepositTypeId,\n      });\n      e.preventDefault();\n    },\n    cancel(e) {\n      this.$emit(\"cancel\", {});\n      e.preventDefault();\n    },\n    getDeposit() {\n      //get_deposit\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/get_deposit/\";\n      axios\n        .post(url, { deposit_id: this.depositId }, { headers })\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.selectedAreaId = response.data[0].result.area_id;\n            this.selectedDistrictId = response.data[0].result.district_id;\n            this.selectedDevType = response.data[0].result.dev_id;\n            this.depositName = response.data[0].result.deposit_name;\n            this.depositDesc = response.data[0].result.description;\n            this.selectedDepositTypeId = response.data[0].result.type_id;\n            this.getAreas();\n            this.getDevelopmentStatuses();\n            this.getDepositTypes();\n          }\n        });\n    },\n    getAreas() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/get_areas/\";\n      axios\n        .post(url, { offset: 0, limit: 20 }, { headers })\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.areas = response.data[0].result;\n            this.getDistricts();\n          }\n        });\n    },\n    getDistricts() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/get_districts/\";\n      axios\n        .post(\n          url,\n          { id_area: this.selectedAreaId, offset: 0, limit: 1000 },\n          { headers }\n        )\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.districts = response.data[0].result;\n          }\n        });\n    },\n    getDepositTypes() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/get_deposit_types/\";\n      axios.post(url, {}, { headers }).then((response) => {\n        if (!response.data[0].auth_fail) {\n          this.types = response.data[0].result;\n        }\n      });\n    },\n    getDevelopmentStatuses() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/get_dictionary_contents/\";\n      axios\n        .post(\n          url,\n          { category: \"SPR_OSV\", offset: 0, limit: 10000 },\n          { headers }\n        )\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.devs = response.data[0].result;\n          }\n        });\n    },\n    changeArea() {\n      this.getDistricts();\n    },\n  },\n  mounted() {\n    this.getDeposit();\n  },\n  components: {\n    OkModal,\n  },\n};\n</script>\n\n<style scoped>\n.modal-mask {\n  position: fixed;\n  z-index: 9998;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  transition: opacity 0.3s ease;\n}\n\n.modal-window {\n  border: rgb(169, 255, 202);\n  background-color: white;\n  position: fixed;\n  width: 500px;\n  height: 600px;\n  top: 50%;\n  left: 50%;\n  margin-top: -300px;\n  margin-left: -250px;\n  z-index: 100;\n}\n\n.header {\n  height: 30px;\n  width: 100%;\n  background-color: rgb(143, 150, 150);\n  text-align: center;\n  font-weight: bold;\n}\n\n.body {\n  font-weight: bolder;\n  color: black;\n  text-align: center;\n}\n\n.close {\n  position: absolute;\n  bottom: 10px;\n  right: 10px;\n}\n\n.save {\n  position: absolute;\n  bottom: 10px;\n  left: 10px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}