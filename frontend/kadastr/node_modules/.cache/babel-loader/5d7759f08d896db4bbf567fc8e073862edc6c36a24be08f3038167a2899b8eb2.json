{"ast":null,"code":"import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, createElementBlock as _createElementBlock, createVNode as _createVNode, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-fcd79da4\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"table\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_OkModal = _resolveComponent(\"OkModal\");\n  const _component_NewMineAreaModal = _resolveComponent(\"NewMineAreaModal\");\n  const _component_MineAreaItem = _resolveComponent(\"MineAreaItem\");\n  const _component_BootstrapIcon = _resolveComponent(\"BootstrapIcon\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [$data.showError ? (_openBlock(), _createBlock(_component_OkModal, {\n    key: 0,\n    message: $data.errorMessage,\n    header: $data.header,\n    onConfirm: $options.hideErrorMessage\n  }, null, 8 /* PROPS */, [\"message\", \"header\", \"onConfirm\"])) : _createCommentVNode(\"v-if\", true), $data.showAuthError ? (_openBlock(), _createBlock(_component_OkModal, {\n    key: 1,\n    message: $data.authMessage,\n    header: $data.authHeader,\n    onConfirm: $options.hideAuthMessage\n  }, null, 8 /* PROPS */, [\"message\", \"header\", \"onConfirm\"])) : _createCommentVNode(\"v-if\", true), $data.showAddNewMineArea ? (_openBlock(), _createBlock(_component_NewMineAreaModal, {\n    key: 2,\n    deposit_id: $props.deposit_id,\n    onCancel: $options.closeAddNew,\n    onSave: $options.saveNew\n  }, null, 8 /* PROPS */, [\"deposit_id\", \"onCancel\", \"onSave\"])) : _createCommentVNode(\"v-if\", true), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.items, item => {\n    return _openBlock(), _createBlock(_component_MineAreaItem, {\n      key: item.mine_area_name,\n      deposit_id: item.deposit_id,\n      mine_area_id: item.mine_area_id,\n      mine_area_name: item.mine_area_name,\n      onMineAreaEdited: $options.onEdit,\n      onMineAreaDeleted: $options.onDeleted,\n      onReservesEditedForMineArea: _ctx.onEditReservesForMineArea\n    }, null, 8 /* PROPS */, [\"deposit_id\", \"mine_area_id\", \"mine_area_name\", \"onMineAreaEdited\", \"onMineAreaDeleted\", \"onReservesEditedForMineArea\"]);\n  }), 128 /* KEYED_FRAGMENT */)), _createElementVNode(\"div\", null, [_createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.onNew && $options.onNew(...args)),\n    class: \"btn btn-dark btn-lg btn-block\",\n    style: {\n      \"float\": \"left\",\n      \"width\": \"300px\"\n    }\n  }, [_createVNode(_component_BootstrapIcon, {\n    icon: \"database-add\",\n    size: \"2x\"\n  }), _createTextVNode(\" Добавить участок \")])])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","$data","showError","_createBlock","_component_OkModal","message","errorMessage","header","onConfirm","$options","hideErrorMessage","showAuthError","authMessage","authHeader","hideAuthMessage","showAddNewMineArea","_component_NewMineAreaModal","deposit_id","$props","onCancel","closeAddNew","onSave","saveNew","_Fragment","_renderList","items","item","_component_MineAreaItem","key","mine_area_name","mine_area_id","onMineAreaEdited","onEdit","onMineAreaDeleted","onDeleted","onReservesEditedForMineArea","_ctx","onEditReservesForMineArea","_createElementVNode","onClick","_cache","args","onNew","style","_createVNode","_component_BootstrapIcon","icon","size"],"sources":["/Users/fayzulla/Dev/kadastr/frontend/kadastr/src/components/MineAreaTable.vue"],"sourcesContent":["<template>\n  <div class=\"table\">\n    <OkModal\n      v-if=\"showError\"\n      v-bind:message=\"errorMessage\"\n      v-bind:header=\"header\"\n      v-on:confirm=\"hideErrorMessage\"\n    />\n    <OkModal\n      v-if=\"showAuthError\"\n      v-bind:message=\"authMessage\"\n      v-bind:header=\"authHeader\"\n      v-on:confirm=\"hideAuthMessage\"\n    />\n    <NewMineAreaModal\n      v-if=\"showAddNewMineArea\"\n      v-bind:deposit_id=\"deposit_id\"\n      v-on:cancel=\"closeAddNew\"\n      v-on:save=\"saveNew\"\n    />\n    <MineAreaItem\n      v-for=\"item in items\"\n      v-bind:key=\"item.mine_area_name\"\n      v-bind:deposit_id=\"item.deposit_id\"\n      v-bind:mine_area_id=\"item.mine_area_id\"\n      v-bind:mine_area_name=\"item.mine_area_name\"\n      v-on:mine-area-edited=\"onEdit\"\n      v-on:mine-area-deleted=\"onDeleted\"\n      v-on:reserves-edited-for-mine-area=\"onEditReservesForMineArea\"\n    />\n    <div>\n      <button\n        @click=\"onNew\"\n        class=\"btn btn-dark btn-lg btn-block\"\n        style=\"float: left; width: 300px\"\n      >\n        <BootstrapIcon icon=\"database-add\" size=\"2x\" />\n        Добавить участок\n      </button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport BootstrapIcon from \"@dvuckovic/vue3-bootstrap-icons\";\nimport OkModal from \"../components/OkModal.vue\";\nimport NewMineAreaModal from \"../components/NewMineAreaModal.vue\";\nimport MineAreaItem from \"../components/MineAreaItem.vue\";\n\nexport default {\n  name: \"MineAreaTable\",\n  props: [\"deposit_id\", \"deposit_name\"],\n  watch: {},\n  data() {\n    return {\n      items: [],\n      totalItems: 0,\n      showAddNewMineArea: false,\n      showEditDeposit: false,\n      currentDepositId: null,\n      showError: false,\n      errorMessage: \"\",\n      header: \"Невозможно сохранить запись\",\n      showAuthError: false,\n      authMessage: \"Доступ запрещен\",\n      authHeader: \"Ошибка безопасности\",\n    };\n  },\n  methods: {\n    hideAuthMessage() {\n      this.showAuthError = false;\n    },\n    loadItems() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/get_mine_areas/\";\n      axios\n        .post(\n          url,\n          { deposit_id: this.deposit_id, offset: 0, limit: 10000 },\n          { headers }\n        )\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.items = response.data[0].result;\n          }\n        });\n    },\n    hideErrorMessage() {\n      this.showError = false;\n    },\n    onDeleted() {\n      this.loadItems();\n    },\n    onEdit() {\n      this.loadItems();\n    },\n    onNew() {\n      this.showAddNewMineArea = true;\n    },\n    closeAddNew() {\n      this.showAddNewMineArea = false;\n    },\n    saveNew(mineArea) {\n      this.showAddNewMineArea = false;\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      var url = this.$BASE_URL + \"/api/add_mine_area/\";\n      axios.post(url, mineArea, { headers }).then((response) => {\n        console.log(JSON.stringify(response.data));\n        if (!response.data[0].auth_fail) {\n          if (!response.data[0].result) {\n            this.errorMessage = response.data[0].reason;\n            this.showError = true;\n          } else {\n            this.loadItems();\n          }\n        } else {\n          this.showAuthError = true;\n        }\n      });\n    },\n  },\n  components: {\n    NewMineAreaModal,\n    MineAreaItem,\n    OkModal,\n    BootstrapIcon,\n  },\n  mounted() {\n    this.loadItems();\n  },\n};\n</script>\n\n<style scoped>\n.table {\n  width: 100%;\n  height: 100%;\n}\n\n.modal-mask {\n  position: fixed;\n  z-index: 9997;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  transition: opacity 0.3s ease;\n}\n\n.modal-window {\n  border: rgb(169, 255, 202);\n  background-color: white;\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  z-index: 100;\n}\n\n.header {\n  height: 30px;\n  width: 100%;\n  background-color: rgb(143, 150, 150);\n  text-align: center;\n  font-weight: bold;\n}\n\n.body {\n  font-weight: bolder;\n  color: black;\n  text-align: center;\n}\n</style>\n"],"mappings":";;;EACOA,KAAK,EAAC;AAAO;;;;;;uBAAlBC,mBAAA,CAuCM,OAvCNC,UAuCM,GArCIC,KAAA,CAAAC,SAAS,I,cADjBC,YAAA,CAKEC,kBAAA;;IAHOC,OAAO,EAAEJ,KAAA,CAAAK,YAAY;IACrBC,MAAM,EAAEN,KAAA,CAAAM,MAAM;IAChBC,SAAO,EAAEC,QAAA,CAAAC;oGAGRT,KAAA,CAAAU,aAAa,I,cADrBR,YAAA,CAKEC,kBAAA;;IAHOC,OAAO,EAAEJ,KAAA,CAAAW,WAAW;IACpBL,MAAM,EAAEN,KAAA,CAAAY,UAAU;IACpBL,SAAO,EAAEC,QAAA,CAAAK;oGAGRb,KAAA,CAAAc,kBAAkB,I,cAD1BZ,YAAA,CAKEa,2BAAA;;IAHOC,UAAU,EAAEC,MAAA,CAAAD,UAAU;IACxBE,QAAM,EAAEV,QAAA,CAAAW,WAAW;IACnBC,MAAI,EAAEZ,QAAA,CAAAa;yHAEbvB,mBAAA,CASEwB,SAAA,QAAAC,WAAA,CARevB,KAAA,CAAAwB,KAAK,EAAbC,IAAI;yBADbvB,YAAA,CASEwB,uBAAA;MAPOC,GAAG,EAAEF,IAAI,CAACG,cAAc;MACxBZ,UAAU,EAAES,IAAI,CAACT,UAAU;MAC3Ba,YAAY,EAAEJ,IAAI,CAACI,YAAY;MAC/BD,cAAc,EAAEH,IAAI,CAACG,cAAc;MACrCE,gBAAgB,EAAEtB,QAAA,CAAAuB,MAAM;MACxBC,iBAAiB,EAAExB,QAAA,CAAAyB,SAAS;MAC5BC,2BAA6B,EAAEC,IAAA,CAAAC;;kCAEtCC,mBAAA,CASM,cARJA,mBAAA,CAOS;IANNC,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEhC,QAAA,CAAAiC,KAAA,IAAAjC,QAAA,CAAAiC,KAAA,IAAAD,IAAA,CAAK;IACb3C,KAAK,EAAC,+BAA+B;IACrC6C,KAAiC,EAAjC;MAAA;MAAA;IAAA;MAEAC,YAAA,CAA+CC,wBAAA;IAAhCC,IAAI,EAAC,cAAc;IAACC,IAAI,EAAC;uBAAO,oBAEjD,E"},"metadata":{},"sourceType":"module","externalDependencies":[]}