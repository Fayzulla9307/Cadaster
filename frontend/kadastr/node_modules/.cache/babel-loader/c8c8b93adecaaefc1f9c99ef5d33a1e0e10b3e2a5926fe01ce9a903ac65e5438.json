{"ast":null,"code":"import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, createVNode as _createVNode, createElementVNode as _createElementVNode, normalizeClass as _normalizeClass, vModelText as _vModelText, withDirectives as _withDirectives, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nconst _withScopeId = n => (_pushScopeId(\"data-v-65b6f451\"), n = n(), _popScopeId(), n);\nconst _hoisted_1 = {\n  class: \"item\"\n};\nconst _hoisted_2 = {\n  style: {\n    \"border-style\": \"none !important\",\n    \"width\": \"100%\"\n  }\n};\nconst _hoisted_3 = {\n  style: {\n    \"border-style\": \"none !important\",\n    \"width\": \"100%\"\n  }\n};\nconst _hoisted_4 = {\n  style: {\n    \"width\": \"50px\",\n    \"border-style\": \"none !important\"\n  }\n};\nconst _hoisted_5 = {\n  style: {\n    \"width\": \"50px\"\n  }\n};\nconst _hoisted_6 = {\n  style: {\n    \"width\": \"50px\"\n  }\n};\nconst _hoisted_7 = [\"disabled\"];\nconst _hoisted_8 = {\n  style: {\n    \"width\": \"50px\"\n  }\n};\nconst _hoisted_9 = {\n  style: {\n    \"width\": \"100%\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ConfirmModal = _resolveComponent(\"ConfirmModal\");\n  const _component_OkModal = _resolveComponent(\"OkModal\");\n  const _component_MineAreaModal = _resolveComponent(\"MineAreaModal\");\n  const _component_ProtocolEditModal = _resolveComponent(\"ProtocolEditModal\");\n  const _component_ComponentSelectionModal = _resolveComponent(\"ComponentSelectionModal\");\n  const _component_BootstrapIcon = _resolveComponent(\"BootstrapIcon\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [$data.showConfirmModal ? (_openBlock(), _createBlock(_component_ConfirmModal, {\n    key: 0,\n    message: $data.confirmMessage,\n    header: $data.confirmHeader,\n    onConfirm: $options.onConfirm,\n    onCancel: $options.onCancel\n  }, null, 8 /* PROPS */, [\"message\", \"header\", \"onConfirm\", \"onCancel\"])) : _createCommentVNode(\"v-if\", true), $data.showAuthError ? (_openBlock(), _createBlock(_component_OkModal, {\n    key: 1,\n    message: $data.authMessage,\n    header: $data.authHeader,\n    onConfirm: $options.hideAuthMessage\n  }, null, 8 /* PROPS */, [\"message\", \"header\", \"onConfirm\"])) : _createCommentVNode(\"v-if\", true), $data.showMineAreaModal ? (_openBlock(), _createBlock(_component_MineAreaModal, {\n    key: 2,\n    deposit_id: $data.depositId,\n    onMineAreasClose: $options.closeMineAreas\n  }, null, 8 /* PROPS */, [\"deposit_id\", \"onMineAreasClose\"])) : _createCommentVNode(\"v-if\", true), $data.showProtocolEditModal ? (_openBlock(), _createBlock(_component_ProtocolEditModal, {\n    key: 3,\n    deposit_id: $props.id_deposit,\n    mine_area_id: $props.id_deposit,\n    component_id: _ctx.component_id,\n    onReselect: $options.closeProtocolEditModal\n  }, null, 8 /* PROPS */, [\"deposit_id\", \"mine_area_id\", \"component_id\", \"onReselect\"])) : _createCommentVNode(\"v-if\", true), $data.showComponentSelectionModal ? (_openBlock(), _createBlock(_component_ComponentSelectionModal, {\n    key: 4,\n    deposit_id: $props.id_deposit,\n    mine_area_id: $props.id_deposit,\n    onConfirm: $options.selectComponent,\n    onCancel: $options.closeAllWindows\n  }, null, 8 /* PROPS */, [\"deposit_id\", \"mine_area_id\", \"onConfirm\", \"onCancel\"])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"table\", _hoisted_2, [_createElementVNode(\"tr\", _hoisted_3, [_createElementVNode(\"td\", _hoisted_4, [_createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.removeItem && $options.removeItem(...args)),\n    class: \"btn btn-dark btn-md btn-block btn-delete\",\n    style: {\n      \"float\": \"left\",\n      \"width\": \"42px\"\n    },\n    title: \"Удалить запись\"\n  }, [_createVNode(_component_BootstrapIcon, {\n    icon: \"trash\"\n  })])]), _createElementVNode(\"td\", _hoisted_5, [_createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.editItem && $options.editItem(...args)),\n    class: \"btn btn-dark btn-md btn-block btn-edit\",\n    style: {\n      \"float\": \"left\",\n      \"width\": \"42px\"\n    },\n    title: \"Редактировать запись\"\n  }, [_createVNode(_component_BootstrapIcon, {\n    icon: \"pencil\"\n  })])]), _createElementVNode(\"td\", _hoisted_6, [_createElementVNode(\"button\", {\n    onClick: _cache[2] || (_cache[2] = (...args) => $options.openProtocolModal && $options.openProtocolModal(...args)),\n    class: _normalizeClass([\"btn btn-md btn-block btn-edit\", $data.hasMineAreas == 0 ? 'btn-dark' : 'btn-danger']),\n    style: {\n      \"float\": \"left\",\n      \"width\": \"42px\"\n    },\n    title: \"Протокол\",\n    disabled: $data.hasMineAreas == 1\n  }, [_createVNode(_component_BootstrapIcon, {\n    icon: \"file-earmark-word\"\n  })], 10 /* CLASS, PROPS */, _hoisted_7)]), _createElementVNode(\"td\", _hoisted_8, [_createElementVNode(\"button\", {\n    onClick: _cache[3] || (_cache[3] = (...args) => $options.editMineAreas && $options.editMineAreas(...args)),\n    class: \"btn btn-dark btn-md btn-block btn-location\",\n    style: {\n      \"float\": \"left\",\n      \"width\": \"42px\"\n    },\n    title: \"Участки месторождения\"\n  }, [_createVNode(_component_BootstrapIcon, {\n    icon: \"pin-map\"\n  })])]), _createElementVNode(\"td\", _hoisted_9, [_withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    class: \"form-control form-control-md\",\n    style: {\n      \"display\": \"inline\",\n      \"width\": \"calc(100%)\"\n    },\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.depositDecription = $event),\n    disabled: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.depositDecription]])])])])]);\n}","map":{"version":3,"names":["class","style","_createElementBlock","_hoisted_1","$data","showConfirmModal","_createBlock","_component_ConfirmModal","message","confirmMessage","header","confirmHeader","onConfirm","$options","onCancel","showAuthError","_component_OkModal","authMessage","authHeader","hideAuthMessage","showMineAreaModal","_component_MineAreaModal","deposit_id","depositId","onMineAreasClose","closeMineAreas","showProtocolEditModal","_component_ProtocolEditModal","$props","id_deposit","mine_area_id","component_id","_ctx","onReselect","closeProtocolEditModal","showComponentSelectionModal","_component_ComponentSelectionModal","selectComponent","closeAllWindows","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","onClick","_cache","args","removeItem","title","_createVNode","_component_BootstrapIcon","icon","_hoisted_5","editItem","_hoisted_6","openProtocolModal","_normalizeClass","hasMineAreas","disabled","_hoisted_8","editMineAreas","_hoisted_9","type","depositDecription","$event"],"sources":["/Users/fayzulla/Dev/kadastr/frontend/kadastr/src/components/DepositItem.vue"],"sourcesContent":["<template>\n  <div class=\"item\">\n    <ConfirmModal\n      v-if=\"showConfirmModal\"\n      v-bind:message=\"confirmMessage\"\n      v-bind:header=\"confirmHeader\"\n      v-on:confirm=\"onConfirm\"\n      v-on:cancel=\"onCancel\"\n    />\n    <OkModal\n      v-if=\"showAuthError\"\n      v-bind:message=\"authMessage\"\n      v-bind:header=\"authHeader\"\n      v-on:confirm=\"hideAuthMessage\"\n    />\n    <MineAreaModal\n      v-bind:deposit_id=\"depositId\"\n      v-on:mine-areas-close=\"closeMineAreas\"\n      v-if=\"showMineAreaModal\"\n    />\n    <ProtocolEditModal\n      v-bind:deposit_id=\"id_deposit\"\n      v-bind:mine_area_id=\"id_deposit\"\n      v-bind:component_id=\"component_id\"\n      v-if=\"showProtocolEditModal\"\n      v-on:reselect=\"closeProtocolEditModal\"\n    />\n    <ComponentSelectionModal\n      v-if=\"showComponentSelectionModal\"\n      v-bind:deposit_id=\"id_deposit\"\n      v-bind:mine_area_id=\"id_deposit\"\n      v-on:confirm=\"selectComponent\"\n      v-on:cancel=\"closeAllWindows\"\n    />\n    <table style=\"border-style: none !important; width: 100%\">\n      <tr style=\"border-style: none !important; width: 100%\">\n        <td style=\"width: 50px; border-style: none !important\">\n          <button\n            @click=\"removeItem\"\n            class=\"btn btn-dark btn-md btn-block btn-delete\"\n            style=\"float: left; width: 42px\" title=\"Удалить запись\"\n          >\n            <BootstrapIcon icon=\"trash\" />\n          </button>\n        </td>\n        <td style=\"width: 50px\">\n          <button\n            @click=\"editItem\"\n            class=\"btn btn-dark btn-md btn-block btn-edit\"\n            style=\"float: left; width: 42px\" title=\"Редактировать запись\"\n          >\n            <BootstrapIcon icon=\"pencil\" />\n          </button>\n        </td>\n        <td style=\"width: 50px\">\n          <button\n            @click=\"openProtocolModal\"\n            class=\"btn btn-md btn-block btn-edit\"\n            v-bind:class=\"hasMineAreas == 0 ? 'btn-dark' : 'btn-danger'\"\n            style=\"float: left; width: 42px\" title=\"Протокол\"\n            :disabled=\"hasMineAreas == 1\"\n          >\n            <BootstrapIcon icon=\"file-earmark-word\" />\n          </button>\n        </td>\n        <td style=\"width: 50px\">\n          <button\n            @click=\"editMineAreas\"\n            class=\"btn btn-dark btn-md btn-block btn-location\"\n            style=\"float: left; width: 42px\" title=\"Участки месторождения\"\n          >\n            <BootstrapIcon icon=\"pin-map\" />\n          </button>\n        </td>\n        <td style=\"width: 100%\">\n          <input\n            type=\"text\"\n            class=\"form-control form-control-md\"\n            style=\"display: inline; width: calc(100%)\"\n            v-model=\"depositDecription\"\n            disabled\n          />\n        </td>\n      </tr>\n    </table>\n  </div>\n</template>\n\n<script>\nimport axios from \"axios\";\nimport BootstrapIcon from \"@dvuckovic/vue3-bootstrap-icons\";\nimport MineAreaModal from \"../components/MineAreaModal.vue\";\nimport ConfirmModal from \"../components/ConfirmModal.vue\";\nimport OkModal from \"../components/OkModal.vue\";\nimport ProtocolEditModal from \"../components/ProtocolEditModal.vue\";\nimport ComponentSelectionModal from \"../components/ComponentSelectionModal.vue\";\n\nexport default {\n  name: \"DepositItem\",\n  props: [\"id_deposit\", \"deposit_name\", \"type_id\", \"type\"],\n  data() {\n    return {\n      depositId: this.id_deposit,\n      depositName: this.deposit_name,\n      depositDecription: this.deposit_name + \", \" + this.type,\n      showEditReserves: false,\n      showMineAreaModal: false,\n      showDepositPropertiesModal: false,\n      confirmMessage: \"\",\n      confirmHeader: \"\",\n      showConfirmModal: false,\n      showAuthError: false,\n      authMessage: \"Доступ запрещен\",\n      authHeader: \"Ошибка безопасности\",\n      hasMineAreas: false,\n      showComponentSelectionModal: false,\n      showProtocolEditModal: false,\n    };\n  },\n  methods: {\n    closeProtocolEditModal() {\n      this.showProtocolEditModal = false;\n    },\n    selectComponent(data) {\n      this.showComponentSelectionModal = false;\n      this.component_id = data.component_id;\n      this.showProtocolEditModal = true;\n    },\n    closeAllWindows() {\n      this.showComponentSelectionModal = false;\n    },\n    openProtocolModal() {\n      this.showComponentSelectionModal = true;\n    },\n    hideAuthMessage() {\n      this.showAuthError = false;\n    },\n    onConfirm() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/api/delete_deposit/\";\n      axios\n        .post(url, { deposit_id: this.depositId }, { headers })\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.$emit(\"deposit-deleted\", {});\n          } else {\n            this.showAuthError = true;\n          }\n        });\n    },\n    getHasMineAreas() {\n      const token = sessionStorage.getItem(\"token\");\n      const headers = {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      };\n      const url = this.$BASE_URL + \"/api/has_mine_areas/\";\n      axios\n        .post(url, { deposit_id: this.depositId }, { headers })\n        .then((response) => {\n          if (!response.data[0].auth_fail) {\n            this.hasMineAreas = response.data[0].result;\n          }\n        });\n    },\n    onCancel() {\n      this.showConfirmModal = false;\n    },\n    removeItem(e) {\n      this.confirmMessage =\n        \"Удалить месторождение? Это приведет к потере данных (лицензий, запасов, а также всех движений и исторических данных!)\";\n      this.confirmHeader = \"Удаление данных!\";\n      this.showConfirmModal = true;\n      e.preventDefault();\n    },\n    editItem(e) {\n      this.$emit(\"deposit-edited\", { deposit_id: this.depositId });\n      e.preventDefault();\n    },\n    editReserves(e) {\n      //this.$emit('reserves-edited-for-deposit', {\"deposit_id\": this.depositId});\n      this.showEditReserves = true;\n      e.preventDefault();\n    },\n    closeEditReserves() {\n      this.showEditReserves = false;\n      //e.preventDefault();\n    },\n    editMineAreas(e) {\n      this.showMineAreaModal = true;\n      e.preventDefault();\n    },\n    editItemProperties(e) {\n      this.showDepositPropertiesModal = true;\n      e.preventDefault();\n    },\n    closeMineAreas() {\n      this.showMineAreaModal = false;\n    },\n    closeDepositPropsModal() {\n      this.showDepositPropertiesModal = false;\n    },\n  },\n  components: {\n    BootstrapIcon,\n    MineAreaModal,\n    ConfirmModal,\n    OkModal,\n    ProtocolEditModal,\n    ComponentSelectionModal,\n  },\n  mounted() {\n    this.getHasMineAreas();\n  },\n};\n</script>\n\n<style scoped>\nimg {\n  height: 30px;\n  width: 30px;\n}\n\n.item {\n  width: calc(100%);\n  height: 50px;\n  font-weight: bolder;\n  font-family: \"Gill Sans\", \"Gill Sans MT\", Calibri, \"Trebuchet MS\", sans-serif;\n  border-style: none !important;\n}\n.delete-btn {\n  height: 30px;\n  display: inline;\n  /*margin-right: 5px;*/\n}\n.save-btn {\n  height: 30px;\n  display: inline-block;\n  /*margin-right: 5px;*/\n}\n.inputfield {\n  display: inline;\n  height: 30px;\n  width: 330px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}